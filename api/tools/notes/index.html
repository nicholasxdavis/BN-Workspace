<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes - Blacnova Workspace</title>
    <link rel="icon" href="https://www.blacnova.net/img/bn_orange.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #d4611c; --primary-light: #e67a35; --dark-bg: #101010; --card-bg: #1a1a1a; --border-color: rgba(255, 255, 255, 0.1); --text-primary: #EEEEEE; --text-secondary: #a1a1aa; }
        html, body { font-family: 'Inter', sans-serif; background-color: var(--dark-bg); color: var(--text-primary); overflow: hidden; height: 100%; }
        #particle-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.7; }
        [x-cloak] { display: none !important; }
        .loader { border: 4px solid rgba(255, 255, 255, 0.2); border-left-color: var(--primary); border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .ql-toolbar { background: #2a2a2a !important; border: 1px solid var(--border-color) !important; border-radius: 0.5rem 0.5rem 0 0; }
        .ql-container { background: var(--card-bg); border: 1px solid var(--border-color) !important; color: var(--text-primary); font-size: 1rem; border-radius: 0 0 0.5rem 0.5rem; }
        .ql-editor { font-family: 'Inter', sans-serif; height: 100%; }
        .ql-snow .ql-stroke { stroke: var(--text-secondary); }
        .ql-snow .ql-picker-label { color: var(--text-secondary); }
    </style>
</head>
<body x-data="notesApp()" x-init="init()" class="h-full flex flex-col">
    <canvas id="particle-bg"></canvas>

    <div class="flex-1 flex overflow-hidden relative z-10">
        <aside class="w-full md:w-[350px] bg-[var(--card-bg)]/80 backdrop-blur-lg border-r border-[var(--border-color)] flex flex-col flex-shrink-0 absolute md:relative inset-y-0 left-0 z-20 transition-transform duration-300"
               :class="{'translate-x-0': !activeNote || !isMobile, '-translate-x-full': activeNote && isMobile}">
            <div class="p-4 border-b border-[var(--border-color)] flex-shrink-0">
                <h1 class="text-xl font-bold flex items-center"><i class="fas fa-sticky-note text-2xl mr-3 text-primary"></i>Notes</h1>
                <a href="../.." class="text-xs text-gray-400 hover:text-white transition-colors mt-2 flex items-center"><i class="fas fa-arrow-left mr-2"></i> Back to Workspace</a>
            </div>
            <div class="p-4 flex justify-between items-center border-b border-[var(--border-color)] flex-shrink-0">
                <input type="search" x-model="searchTerm" placeholder="Search notes..." class="bg-[#2a2a2a] border border-[var(--border-color)] rounded-lg px-3 py-1.5 w-full text-sm">
                <button @click="createNewNote()" class="ml-2 flex-shrink-0 bg-primary h-8 w-8 rounded-lg flex items-center justify-center"><i class="fas fa-plus"></i></button>
            </div>
            
            <div class="flex-1 overflow-y-auto p-2">
                <div class="px-2 pb-2">
                     <button @click="createNewFolder()" class="w-full text-left text-xs text-gray-400 hover:text-white py-1 flex justify-between items-center">
                        <span>FOLDERS</span><i class="fas fa-plus"></i>
                    </button>
                    <a href="#" @click.prevent="setActiveFolder(null)" class="block px-2 py-1.5 rounded-md text-sm truncate" :class="activeFolderId === null ? 'bg-primary/20 text-white' : 'text-gray-300 hover:bg-white/5'">All Notes</a>
                    <template x-for="folder in folders" :key="folder.id">
                        <a href="#" @click.prevent="setActiveFolder(folder.id)" class="block px-2 py-1.5 rounded-md text-sm truncate" :class="activeFolderId === folder.id ? 'bg-primary/20 text-white' : 'text-gray-300 hover:bg-white/5'" x-text="folder.name"></a>
                    </template>
                </div>
                
                <div class="mt-4 px-2">
                    <h3 class="text-xs text-gray-400">NOTES</h3>
                    <template x-for="note in filteredNotes" :key="note.id">
                        <div @click="selectNote(note.id)" class="p-2 mt-1 cursor-pointer rounded-md" :class="activeNote && activeNote.id === note.id ? 'bg-primary/20' : 'hover:bg-white/5'">
                            <h4 class="font-bold truncate text-sm" x-text="note.title || 'Untitled Note'"></h4>
                            <p class="text-xs text-gray-400 truncate mt-1" x-text="note.snippet || 'No additional text'"></p>
                        </div>
                    </template>
